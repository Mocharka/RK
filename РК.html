<!DOCTYPE html>
<html>
<head> 
<title>РК</title>
       <meta charset="UTF-8">
	   
	   <style>
li {
list-style-type: none;

}   

span {
cursor: pointer;
}



	   </style>
	   
</head>
<body>
<h1>Дерево</h1>

<form>
            
            <input type="button" id="but1" value="Создать">
            <br><br>
            <input type="button" id="but2" value="Переименовать">
            <br><br>
            <input type="button" id="but3" value="Удалить">
</form>

<ul id = "main">
 <li>Корневой элемент
      <ul id = "one">
        <li>1
          <ul>
            <li>1.1<ul><li>1.1.1</li></ul></li>
          </ul>
        </li>
        <li>2
          <ul>
            <li>2.2</li>
          </ul>
        </li>
      </ul>
    </li>
</ul>

<script>



for ( let li of main.querySelectorAll('li')) {			
let span = document.createElement('span');
let img = document.createElement ('img');
img.setAttribute('src', 'minus.png');
li.prepend(span);

span.append(span.nextSibling);
li.prepend(img);
}

main.onclick = function (e) {							
if (e.target.tagName != 'IMG') return;
let cont = e.target.parentNode.querySelector('ul');
if (!cont) return;
cont.hidden = !cont.hidden;

if (cont.hidden) {

let d = e.target;
let clos = d.closest('li');
clos.removeChild(d);
let img = document.createElement ('img');
img.setAttribute('src', 'plus.png');
clos.prepend(img);
}

if (!cont.hidden) {

let d = e.target;
let clos = d.closest('li');
clos.removeChild(d);
let img = document.createElement ('img');
img.setAttribute('src', 'minus.png');
clos.prepend(img);
}
}


let a = 0;
let b = 0;
let q = 0;

document.body.onclick = function (e){

for ( let span of main.querySelectorAll('span')) {	
span.style.backgroundColor = 'white';
	
}

if (e.target.tagName != 'SPAN') return;
e.target.style.backgroundColor = '#00CCFF';
a = e.target;
}
 
 
document.getElementById('but2').onclick = function(){       
      let txt = prompt('Введите новое слово');                               
         var clos = a.closest('li');
			var	children = clos.firstChild.nextSibling;
				
				children.innerHTML=txt;
                }


document.getElementById('but1').onclick = function(){  		
     let txt = prompt('Ввведите название');
	   var clos = a.closest('li');
		 var li = document.createElement('li');
		 var ul = document.createElement('ul');
		
			var children1 = clos.lastElementChild;
			var children2 = children1.lastElementChild;
			var zap = children2;
			if (children2 == null) {clos.appendChild(ul)};
			var children1 = clos.lastElementChild;
			
			
			children1.appendChild(li);
			var children3 = children1.lastElementChild;
			children3.innerHTML = txt;
			
let span = document.createElement('span');
children3.prepend(span);
span.append(span.nextSibling);
 
let img = document.createElement ('img');
img.setAttribute('src', 'minus.png');
li.prepend(span);

span.append(span.nextSibling);
li.prepend(img);
}
 
 
document.getElementById('but3').onclick = function(){        
        var clos = a;                        
         clos.parentNode.remove(clos);

}

</script>
</body>
</html>
